apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - namespace.yaml
  # Loki (not managed by kube-prometheus-stack)
  - loki/rbac.yaml
  - loki/configmap.yaml
  - loki/statefulset.yaml
  - loki/service.yaml
  # Alloy (not managed by kube-prometheus-stack)
  - alloy/rbac.yaml
  - alloy/configmap.yaml
  - alloy/daemonset.yaml
  - alloy/service.yaml
  # Prometheus Gateway/HTTPRoute/oauth2-proxy (chart doesn't manage Gateway API)
  - prometheus/oauth2-proxy.yaml
  - prometheus/middleware-oauth2-proxy.yaml
  - prometheus/gateway.yaml
  - prometheus/httproute.yaml
  # Alertmanager Gateway/HTTPRoute/oauth2-proxy
  - alertmanager/oauth2-proxy.yaml
  - alertmanager/middleware-oauth2-proxy.yaml
  - alertmanager/gateway.yaml
  - alertmanager/httproute.yaml
  # Grafana Gateway/HTTPRoute
  - grafana/gateway.yaml
  - grafana/httproute.yaml
  # Grafana dashboard ConfigMaps (sidecar discovers via grafana_dashboard: "1")
  - grafana/configmap-dashboard-etcd.yaml
  - grafana/configmap-dashboard-loki.yaml
  - grafana/configmap-dashboard-loki-stack.yaml
  - grafana/configmap-dashboard-vault.yaml
  - grafana/configmap-dashboard-cert-manager.yaml
  - grafana/configmap-dashboard-cilium.yaml
  - grafana/configmap-dashboard-traefik.yaml
  - grafana/configmap-dashboard-cnpg.yaml
  - grafana/configmap-dashboard-gitlab.yaml
  - grafana/configmap-dashboard-coredns.yaml
  - grafana/configmap-dashboard-node-detail.yaml
  - grafana/configmap-dashboard-apiserver.yaml
  - grafana/configmap-dashboard-storage.yaml
  - grafana/configmap-dashboard-argocd.yaml
  - grafana/configmap-dashboard-harbor.yaml
  - grafana/configmap-dashboard-dhi-builder.yaml
  - grafana/configmap-dashboard-keycloak.yaml
  - grafana/configmap-dashboard-mattermost.yaml
  - grafana/configmap-dashboard-argo-rollouts.yaml
  - grafana/configmap-dashboard-home.yaml
  - grafana/configmap-dashboard-firing-alerts.yaml
  - grafana/configmap-dashboard-node-labeler.yaml
  - grafana/configmap-dashboard-redis.yaml
  - grafana/configmap-dashboard-security-advanced.yaml
  - grafana/configmap-dashboard-oauth2-proxy.yaml
  - grafana/configmap-dashboard-identity-portal.yaml
  # Service aliases (backwards-compat for HTTPRoutes, datasources, AnalysisTemplates)
  - prometheus-service-alias.yaml
  - alertmanager-service-alias.yaml
  # oauth2-proxy Redis session store â€” deployed explicitly in Phase 5 (Keycloak+Auth)
  # to co-locate with oauth2-proxy instances. Removed from kustomize to avoid
  # deploying unused Redis in Phase 3 before any oauth2-proxy consumers exist.
  # - oauth2-proxy-redis/secret.yaml
  # - oauth2-proxy-redis/replication.yaml
  # - oauth2-proxy-redis/sentinel.yaml
  # kube-system resources
  - kube-system/oauth2-proxy-hubble.yaml
  - kube-system/middleware-oauth2-proxy-hubble.yaml
  - kube-system/oauth2-proxy-traefik-dashboard.yaml
  - kube-system/middleware-oauth2-proxy-traefik-dashboard.yaml
  - kube-system/traefik-default-tlsstore.yaml
  - kube-system/hubble-gateway.yaml
  - kube-system/hubble-httproute.yaml
  - kube-system/traefik-dashboard-certificate.yaml
  - kube-system/traefik-dashboard-ingressroute.yaml
