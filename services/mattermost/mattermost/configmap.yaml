apiVersion: v1
kind: ConfigMap
metadata:
  name: mattermost-config
  namespace: mattermost
data:
  # Site
  MM_SERVICESETTINGS_SITEURL: "https://mattermost.example.com"
  MM_SERVICESETTINGS_LISTENADDRESS: ":8065"

  # Database
  MM_SQLSETTINGS_DRIVERNAME: postgres
  MM_SQLSETTINGS_MAXIDLECONNS: "20"
  MM_SQLSETTINGS_MAXOPENCONNS: "100"
  MM_SQLSETTINGS_CONNMAXLIFETIMEMILLISECONDS: "3600000"

  # File storage (S3 via MinIO)
  MM_FILESETTINGS_DRIVERNAME: amazons3
  MM_FILESETTINGS_AMAZONS3BUCKET: mattermost
  MM_FILESETTINGS_AMAZONS3ENDPOINT: "mattermost-minio.mattermost.svc.cluster.local:9000"
  MM_FILESETTINGS_AMAZONS3SSL: "false"
  MM_FILESETTINGS_AMAZONS3REGION: ""
  MM_FILESETTINGS_MAXFILESIZE: "104857600"

  # Logging
  MM_LOGSETTINGS_ENABLECONSOLE: "true"
  MM_LOGSETTINGS_CONSOLEJSON: "true"
  MM_LOGSETTINGS_CONSOLELEVEL: INFO
  MM_LOGSETTINGS_ENABLEFILE: "false"

  # Metrics (Prometheus)
  MM_METRICSSETTINGS_ENABLE: "true"
  MM_METRICSSETTINGS_LISTENADDRESS: ":8067"

  # Cluster (HA-ready, disabled until Enterprise license)
  MM_CLUSTERSETTINGS_ENABLE: "false"
  MM_CLUSTERSETTINGS_CLUSTERNAME: mattermost-prod
  MM_CLUSTERSETTINGS_USEIPADDRESS: "true"
  MM_CLUSTERSETTINGS_GOSSIPPORT: "8074"

  # Service settings
  MM_SERVICESETTINGS_ENABLELOCALMODE: "true"
  MM_SERVICESETTINGS_LOCALMODESOCKETLOCATION: "/var/tmp/mattermost_local.socket"

  # Plugin settings
  MM_PLUGINSETTINGS_ENABLEUPLOADS: "true"

  # Email (disabled â€” configure SMTP later)
  MM_EMAILSETTINGS_ENABLESMTPAUTH: "false"
  MM_EMAILSETTINGS_SMTPSERVER: ""
  MM_EMAILSETTINGS_SMTPPORT: ""
  MM_EMAILSETTINGS_SENDEMAILNOTIFICATIONS: "false"
  MM_EMAILSETTINGS_FEEDBACKEMAIL: "mattermost@example.com"
  MM_EMAILSETTINGS_FEEDBACKNAME: "Mattermost"
